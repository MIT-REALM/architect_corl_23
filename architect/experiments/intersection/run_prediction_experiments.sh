#!/bin/bash

conda activate architect_env

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --savename intersection_lqr_patch &

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --savename intersection_lqr_patch &

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --savename intersection_lqr_patch &

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --savename intersection_lqr_patch &


# repair
wait; 
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --repair --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=2, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --repair --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --repair --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --repair --savename intersection_lqr_patch &
EXPNAME="rmh" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_gradients --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="l2c" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --reinforce --no-temper --repair --savename intersection_lqr_patch &
EXPNAME="gd" CUDA_VISIBLE_DEVICES=1, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 30 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --disable_stochasticity --no-temper --repair --savename intersection_lqr_patch &

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 0 --num_rounds 50 --quench_rounds 25 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 5e-3 --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 1 --num_rounds 50 --quench_rounds 25 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 5e-3 --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 2 --num_rounds 50 --quench_rounds 25 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 5e-3 --repair --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=3, XLA_PYTHON_CLIENT_MEM_FRACTION=0.1 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 10 --seed 3 --num_rounds 50 --quench_rounds 25 --num_steps_per_round 1 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 5e-3 --repair --savename intersection_lqr_patch &

EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.05 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 1 --seed 0 --num_rounds 10 --num_steps_per_round 3 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.05 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 1 --seed 1 --num_rounds 10 --num_steps_per_round 3 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.05 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 1 --seed 2 --num_rounds 10 --num_steps_per_round 3 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &
EXPNAME="mala_t" CUDA_VISIBLE_DEVICES=0, XLA_PYTHON_CLIENT_MEM_FRACTION=0.05 python architect/experiments/intersection/predict_and_mitigate.py --model_path results/intersection_lqr_patch/initial_policy.eqx --L 1 --seed 3 --num_rounds 10 --num_steps_per_round 3 --num_chains 10 --ep_mcmc_step_size 1e-2 --dp_mcmc_step_size 1e-2 --savename intersection_lqr_patch &